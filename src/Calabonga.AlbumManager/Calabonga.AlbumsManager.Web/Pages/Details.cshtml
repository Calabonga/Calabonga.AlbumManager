@page "/details/{PageIndex=0}/{FolderName}"
@using Calabonga.AlbumsManager.CommandProcessors.Commands
@model DetailsModel
@{
    ViewData["Title"] = Model.FolderName;
}

<h1>@ViewData["Title"]</h1>

@if (Model.SelectedImage is not null)
{
    <div class="border">
        <img src="data:image/jpeg;base64, @Convert.ToBase64String(Model.SelectedImage.OriginalBytes!)" />
    </div>
}

@if (Model.PagedList is not null && Model.PagedList.Items.Any())
{
    @if (Model.PagedList.HasPreviousPage)
    {
        <a class="btn btn-outline-secondary" asp-page="Details" asp-route-PageIndex="@(Model.PagedList.PageIndex-1)" asp-route-FolderName="@Model.FolderName">←</a>
    }
    else
    {
        <button class="btn btn-outline-secondary" disabled>←</button>
    }
    @if (Model.PagedList.HasNextPage)
    {
        <a class="btn btn-outline-secondary" asp-page="Details" asp-route-PageIndex="@(Model.PagedList.PageIndex+1)" asp-route-FolderName="@Model.FolderName">→</a>
    }
    else
    {
        <button class="btn btn-outline-secondary" disabled>→</button>
    }

    foreach (var item in Model.PagedList.Items)
    {
        @if (string.IsNullOrEmpty(item.Title))
        {
            <h3>@item.Name</h3>
        }
        else
        {
            <h2>@item.Title</h2>
        }
        <div class="m-2">
            <img src="data:image/jpeg;base64, @Convert.ToBase64String(item.OriginalBytes!)" class="img-fluid" />
        </div>

        <div class="mt-3">
            <p class="lead">@item.Description</p>
        </div>

        <div class="mt-2">

            <div class="btn-group">

                <a asp-page-handler="ImageById"
                   asp-route-fileName="@item.Name"
                   class="btn btn-secondary">@(nameof(GetImageByIdCommand))</a>

                <a asp-page-handler="DeleteImageById"
                   asp-route-fileName="@item.Name"
                   class="btn btn-danger">@(nameof(DeleteImageByIdCommand))</a>

            </div>
        </div>
    }
}
